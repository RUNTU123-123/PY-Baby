name: 自动保持仓库活跃
on:
  schedule:
    - cron: '0 1 * * *'  # 每天UTC1点执行（北京时间9点）
      timezone: Asia/Shanghai
  workflow_dispatch:

jobs:
  keep-active:
    runs-on: ubuntu-latest
    steps:
      - name: 拉取代码
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # 拉取所有历史提交，避免提交失败

      - name: 配置Git用户信息（必须，否则无法提交）
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"

      - name: 自动更新活跃日志（空变更，仅更新时间戳）
        run: |
          # 创建/更新活跃日志文件，仅写入当前时间（无实际代码变更）
          echo "仓库活跃保持 - 最后更新时间：$(date +'%Y-%m-%d %H:%M:%S')" > .github/keep_active.log
          # 检查是否有变更（避免无意义的提交）
          if git status --porcelain | grep -q .; then
            git add .github/keep_active.log
            git commit -m "chore: 自动保持仓库活跃 [skip ci]"  # [skip ci] 避免触发其他Workflow
            git push origin main  # 替换为你的仓库默认分支（如master）
            echo "成功提交，仓库活跃状态已重置"
          else
            echo "无变更需要提交，跳过"
          fi
